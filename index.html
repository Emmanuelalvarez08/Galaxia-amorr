<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Para Diana üíñ</title>

<style>
body{
  margin:0;
  overflow:hidden;
  background:#000;
  font-family:Arial, sans-serif;
  color:white;
  text-align:center;
}

/* CANVAS */
canvas{
  position:fixed;
  inset:0;
}

/* CAPAS */
#heartsCanvas{ z-index:0; }
#galaxy{ z-index:1; }

#surpriseLayer{
  position:fixed;
  inset:0;
  z-index:5;
  pointer-events:none;
}

/* CONTADOR (dentro de la sorpresa) */
#loveCounter{
  position:fixed;
  top:16px;
  left:50%;
  transform:translateX(-50%);
  padding:10px 14px;
  border-radius:16px;
  background:rgba(0,0,0,.45);
  color:pink;
  font-size:16px;
  box-shadow:0 0 18px rgba(255,105,180,.35);
  z-index:9;
  display:none; /* se muestra cuando inicia la sorpresa */
}

/* BOT√ìN */
#startBtn{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  padding:22px 60px;
  font-size:28px;
  background:#ff69b4;
  color:white;
  border:none;
  border-radius:30px;
  cursor:pointer;
  box-shadow:0 0 30px hotpink;
  z-index:10;
  animation:pulse 2s infinite;
}
@keyframes pulse{
  0%{transform:translate(-50%,-50%) scale(1)}
  50%{transform:translate(-50%,-50%) scale(1.08)}
  100%{transform:translate(-50%,-50%) scale(1)}
}

/* ORBITAS */
.orbit{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
}

/* FOTOS / VIDEOS */
.floatingMedia{
  position:absolute;
  width:150px;
  border-radius:18px;
  box-shadow:0 0 25px rgba(255,192,203,.9);
  transform:translate(-50%,-50%);
}

/* FRASES */
.floatingText{
  position:absolute;
  transform:translate(-50%,-50%);
  font-size:24px;
  color:pink;
  text-shadow:0 0 18px hotpink;
  white-space:nowrap;
  padding:10px 14px;
  border-radius:20px;
  background:rgba(0,0,0,.25);
  backdrop-filter: blur(3px);
}
</style>
</head>

<body>

<canvas id="heartsCanvas"></canvas>
<canvas id="galaxy"></canvas>
<div id="surpriseLayer"></div>

<div id="loveCounter"></div>
<button id="startBtn">üíñ Toca baby üíï</button>

<script>
/* ================= üíñ CORAZONES DE FONDO (M√ÅS VISIBLES) ================= */
const heartsCanvas = document.getElementById("heartsCanvas");
const hctx = heartsCanvas.getContext("2d");

function resizeHearts(){
  heartsCanvas.width = innerWidth;
  heartsCanvas.height = innerHeight;
}
resizeHearts();
addEventListener("resize", resizeHearts);

const heartColors = ["#ff69b4", "#ff9ccc", "#ff4da6", "#ffd1e8"];
let hearts = [];
const HEARTS_COUNT = 180;

for(let i=0;i<HEARTS_COUNT;i++){
  hearts.push({
    x: Math.random()*innerWidth,
    y: Math.random()*innerHeight,
    size: 10 + Math.random()*18,
    alpha: 0.2 + Math.random()*0.8,
    alphaSpeed: 0.006 + Math.random()*0.012,
    driftX: (Math.random()*0.3 - 0.15),
    driftY: (Math.random()*0.25 - 0.12),
    color: heartColors[Math.floor(Math.random()*heartColors.length)]
  });
}

function drawHeart(x,y,s){
  hctx.beginPath();
  hctx.moveTo(x, y);
  hctx.bezierCurveTo(x - s, y - s, x - s*2, y + s, x, y + s*2);
  hctx.bezierCurveTo(x + s*2, y + s, x + s, y - s, x, y);
  hctx.closePath();
  hctx.fill();
}

function animateHearts(){
  hctx.clearRect(0,0,heartsCanvas.width,heartsCanvas.height);

  hearts.forEach(h=>{
    h.alpha += h.alphaSpeed;
    if(h.alpha > 1 || h.alpha < 0.15) h.alphaSpeed *= -1;

    h.x += h.driftX;
    h.y += h.driftY;

    if(h.x < -50) h.x = innerWidth + 50;
    if(h.x > innerWidth + 50) h.x = -50;
    if(h.y < -50) h.y = innerHeight + 50;
    if(h.y > innerHeight + 50) h.y = -50;

    hctx.globalAlpha = h.alpha;
    hctx.shadowColor = h.color;
    hctx.shadowBlur = 18;
    hctx.fillStyle = h.color;
    drawHeart(h.x, h.y, h.size);
  });

  hctx.shadowBlur = 0;
  hctx.globalAlpha = 1;
  requestAnimationFrame(animateHearts);
}
animateHearts();

/* ================= üåå GALAXIA ================= */
const galaxy = document.getElementById("galaxy");
const gctx = galaxy.getContext("2d");

function resizeGalaxy(){
  galaxy.width = innerWidth;
  galaxy.height = innerHeight;
}
resizeGalaxy();
addEventListener("resize", resizeGalaxy);

const colors=["#fff","#ff9ccc","#ff69b4","#ffb6c1","#ff4da6"];
let stars=[];
for(let i=0;i<900;i++){
  stars.push({
    a:Math.random()*Math.PI*2,
    r:Math.random()*360,
    s:0.0012+Math.random()*0.003,
    o:Math.random(),
    os:0.004+Math.random()*0.01,
    c:colors[Math.floor(Math.random()*colors.length)]
  });
}

function animateGalaxy(){
  gctx.clearRect(0,0,galaxy.width,galaxy.height);
  gctx.save();
  gctx.translate(galaxy.width/2, galaxy.height/2);
  stars.forEach(st=>{
    st.a+=st.s;
    st.o+=st.os;
    if(st.o>1||st.o<0) st.os*=-1;
    gctx.globalAlpha=st.o;
    gctx.fillStyle=st.c;
    gctx.beginPath();
    gctx.arc(Math.cos(st.a)*st.r,Math.sin(st.a)*st.r,2,0,Math.PI*2);
    gctx.fill();
  });
  gctx.restore();
  gctx.globalAlpha=1;
  requestAnimationFrame(animateGalaxy);
}
animateGalaxy();

/* ================= üéµ M√öSICA (A PRUEBA DE BLOQUEOS) ================= */
const music = new Audio("./cancion.mp3");
music.loop = true;
music.preload = "auto";
music.volume = 0.85;

function showAudioMsg(txt){
  let box = document.getElementById("audioMsg");
  if(!box){
    box = document.createElement("div");
    box.id = "audioMsg";
    box.style.position = "fixed";
    box.style.left = "50%";
    box.style.top = "56px";
    box.style.transform = "translateX(-50%)";
    box.style.padding = "10px 14px";
    box.style.borderRadius = "14px";
    box.style.background = "rgba(0,0,0,.55)";
    box.style.color = "pink";
    box.style.fontSize = "14px";
    box.style.zIndex = "9999";
    box.style.boxShadow = "0 0 18px rgba(255,105,180,.35)";
    document.body.appendChild(box);
  }
  box.textContent = txt;
  setTimeout(()=> box.remove(), 5000);
}

async function tryPlayMusic(){
  try{ await music.play(); }
  catch(e){ showAudioMsg("üîá Toca la pantalla una vez para activar el audio."); }
}

fetch("./cancion.mp3", { method: "HEAD" })
  .then(r => { if(!r.ok) showAudioMsg("‚ùå No se encuentra: cancion.mp3 (revisa nombre en GitHub)"); })
  .catch(()=> showAudioMsg("‚ùå No se pudo cargar cancion.mp3"));

window.addEventListener("pointerdown", () => { tryPlayMusic(); }, { once:true });
window.addEventListener("touchstart", () => { tryPlayMusic(); }, { once:true });

/* ================= üíñ CONTADOR DE AMOR (DENTRO DE LA SORPRESA) ================= */
const loveCounter = document.getElementById("loveCounter");
const loveStart = new Date("June 20, 2024 00:00:00").getTime(); // <-- cambia esta fecha si quer√©s

function updateLoveCounter(){
  const now = Date.now();
  const diff = now - loveStart;

  const d = Math.floor(diff / (1000*60*60*24));
  const h = Math.floor((diff / (1000*60*60)) % 24);
  const m = Math.floor((diff / (1000*60)) % 60);

  loveCounter.textContent = `Te he querido por ${d} d√≠as, ${h} horas y ${m} minutos üíñ`;
}

/* ================= üíñ SORPRESA ORBITANDO ================= */
const layer=document.getElementById("surpriseLayer");
const phrases=[
  "Te amo ranita üíñüê∏",
  "Gracias por existir üåπ",
  "Eres mi universo ‚ú®",
  "Mi Diana hermosa üíû",
  "Siempre juntos ‚ù§Ô∏è",
  "Mi lugar favorito eres t√∫ üíò"
];

let orbiters=[];
function makeOrbit(node,r,s,a){
  const o=document.createElement("div");
  o.className="orbit";
  o.dataset.r=r;
  o.dataset.s=s;
  o.dataset.a=a;
  o.appendChild(node);
  layer.appendChild(o);
  orbiters.push(o);
}

function orbitLoop(){
  const t=performance.now();
  orbiters.forEach(o=>{
    const r=+o.dataset.r;
    const s=+o.dataset.s;
    const a=+o.dataset.a + t*s;
    o.style.transform=`translate(-50%,-50%) translate(${Math.cos(a)*r}px,${Math.sin(a)*(r*0.7)}px)`;
  });
  requestAnimationFrame(orbitLoop);
}

function spawn(){
  ["foto1.jpg","foto2.jpg"].forEach((src,i)=>{
    const img=document.createElement("img");
    img.src=src;
    img.className="floatingMedia";
    makeOrbit(img,320+i*180,0.00025+i*0.00008,Math.random()*Math.PI*2);
  });

  ["video1.mp4","video2.mp4"].forEach((src,i)=>{
    const v=document.createElement("video");
    v.src=src; v.autoplay=true; v.loop=true; v.muted=true; v.playsInline=true;
    v.className="floatingMedia";
    makeOrbit(v,420+i*200,0.00018+i*0.00007,Math.random()*Math.PI*2);
  });

  phrases.forEach((txt,i)=>{
    const t=document.createElement("div");
    t.className="floatingText";
    t.innerText=txt;
    makeOrbit(t,220+i*120,0.00035+i*0.00005,Math.random()*Math.PI*2);
  });

  orbitLoop();
}

startBtn.onclick=async()=>{
  await tryPlayMusic();

  // mostrar y activar contador
  loveCounter.style.display = "block";
  updateLoveCounter();
  setInterval(updateLoveCounter, 60000);

  startBtn.style.display="none";
  spawn();
};
</script>

</body>
</html>
