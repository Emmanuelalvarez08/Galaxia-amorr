<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Para Diana üíñ</title>

<style>
  body{
    margin:0;
    overflow:hidden;
    background:#000;
    font-family:Arial, sans-serif;
    color:white;
    text-align:center;
  }

  canvas{ position:fixed; inset:0; }
  #heartsCanvas{ z-index:0; }
  #galaxy{ z-index:1; }

  #surpriseLayer{
    position:fixed;
    inset:0;
    z-index:5;
    pointer-events:none;
  }

  /* CONTADOR */
  #loveCounter{
    position:fixed;
    top:14px;
    left:50%;
    transform:translateX(-50%);
    padding:10px 14px;
    border-radius:16px;
    background:rgba(0,0,0,.55);
    color:pink;
    font-size:16px;
    box-shadow:0 0 18px rgba(255,105,180,.35);
    z-index:9998;
    display:none;
    backdrop-filter: blur(3px);
    white-space:nowrap;
  }

  /* MENSAJE / BOT√ìN AUDIO */
  #audioBar{
    position:fixed;
    top:56px;
    left:50%;
    transform:translateX(-50%);
    z-index:9999;
    display:none;
    gap:10px;
    align-items:center;
    justify-content:center;
    max-width:92vw;
  }
  #audioMsg{
    padding:10px 14px;
    border-radius:16px;
    background:rgba(0,0,0,.55);
    color:pink;
    font-size:14px;
    box-shadow:0 0 18px rgba(255,105,180,.35);
    backdrop-filter: blur(3px);
  }
  #audioBtn{
    padding:10px 14px;
    border-radius:16px;
    border:none;
    cursor:pointer;
    background:#ff69b4;
    color:white;
    box-shadow:0 0 18px rgba(255,105,180,.35);
  }

  /* BOT√ìN PRINCIPAL */
  #startBtn{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    padding:22px 60px;
    font-size:28px;
    background:#ff69b4;
    color:white;
    border:none;
    border-radius:30px;
    cursor:pointer;
    box-shadow:0 0 30px hotpink;
    z-index:10;
    animation:pulse 2s infinite;
  }
  @keyframes pulse{
    0%{transform:translate(-50%,-50%) scale(1)}
    50%{transform:translate(-50%,-50%) scale(1.08)}
    100%{transform:translate(-50%,-50%) scale(1)}
  }

  /* ORBITAS */
  .orbit{
    position:absolute;
    left:50%;
    top:50%;
    transform:translate(-50%,-50%);
  }

  .floatingMedia{
    position:absolute;
    width:150px;
    border-radius:18px;
    box-shadow:0 0 25px rgba(255,192,203,.9);
    transform:translate(-50%,-50%);
  }

  .floatingText{
    position:absolute;
    transform:translate(-50%,-50%);
    font-size:24px;
    color:pink;
    text-shadow:0 0 18px hotpink;
    white-space:nowrap;
    padding:10px 14px;
    border-radius:20px;
    background:rgba(0,0,0,.25);
    backdrop-filter: blur(3px);
  }
</style>
</head>

<body>
  <canvas id="heartsCanvas"></canvas>
  <canvas id="galaxy"></canvas>

  <div id="surpriseLayer"></div>

  <div id="loveCounter"></div>

  <div id="audioBar">
    <div id="audioMsg"></div>
    <button id="audioBtn">‚ñ∂ Activar m√∫sica</button>
  </div>

  <button id="startBtn">üíñ Toca baby üíï</button>

<script>
/* ================= üíñ CORAZONES DE FONDO ================= */
const heartsCanvas = document.getElementById("heartsCanvas");
const hctx = heartsCanvas.getContext("2d");

function resizeHearts(){
  heartsCanvas.width = innerWidth;
  heartsCanvas.height = innerHeight;
}
resizeHearts();
addEventListener("resize", resizeHearts);

const heartColors = ["#ff69b4", "#ff9ccc", "#ff4da6", "#ffd1e8"];
const HEARTS_COUNT = 180;

let hearts = Array.from({length: HEARTS_COUNT}, () => ({
  x: Math.random()*innerWidth,
  y: Math.random()*innerHeight,
  size: 10 + Math.random()*18,
  alpha: 0.2 + Math.random()*0.8,
  alphaSpeed: 0.006 + Math.random()*0.012,
  driftX: (Math.random()*0.3 - 0.15),
  driftY: (Math.random()*0.25 - 0.12),
  color: heartColors[Math.floor(Math.random()*heartColors.length)]
}));

function drawHeart(x,y,s){
  hctx.beginPath();
  hctx.moveTo(x, y);
  hctx.bezierCurveTo(x - s, y - s, x - s*2, y + s, x, y + s*2);
  hctx.bezierCurveTo(x + s*2, y + s, x + s, y - s, x, y);
  hctx.closePath();
  hctx.fill();
}

function animateHearts(){
  hctx.clearRect(0,0,heartsCanvas.width,heartsCanvas.height);
  for (const h of hearts){
    h.alpha += h.alphaSpeed;
    if(h.alpha > 1 || h.alpha < 0.15) h.alphaSpeed *= -1;

    h.x += h.driftX; h.y += h.driftY;
    if(h.x < -50) h.x = innerWidth + 50;
    if(h.x > innerWidth + 50) h.x = -50;
    if(h.y < -50) h.y = innerHeight + 50;
    if(h.y > innerHeight + 50) h.y = -50;

    hctx.globalAlpha = h.alpha;
    hctx.shadowColor = h.color;
    hctx.shadowBlur = 18;
    hctx.fillStyle = h.color;
    drawHeart(h.x, h.y, h.size);
  }
  hctx.shadowBlur = 0;
  hctx.globalAlpha = 1;
  requestAnimationFrame(animateHearts);
}
animateHearts();

/* ================= üåå GALAXIA ================= */
const galaxy = document.getElementById("galaxy");
const gctx = galaxy.getContext("2d");

function resizeGalaxy(){
  galaxy.width = innerWidth;
  galaxy.height = innerHeight;
}
resizeGalaxy();
addEventListener("resize", resizeGalaxy);

const starColors = ["#fff","#ff9ccc","#ff69b4","#ffb6c1","#ff4da6"];
let stars = [];
for(let i=0;i<900;i++){
  stars.push({
    a:Math.random()*Math.PI*2,
    r:Math.random()*360,
    s:0.0012+Math.random()*0.003,
    o:Math.random(),
    os:0.004+Math.random()*0.01,
    c:starColors[Math.floor(Math.random()*starColors.length)]
  });
}

function animateGalaxy(){
  gctx.clearRect(0,0,galaxy.width,galaxy.height);
  gctx.save();
  gctx.translate(galaxy.width/2, galaxy.height/2);
  for (const st of stars){
    st.a += st.s;
    st.o += st.os;
    if(st.o>1 || st.o<0) st.os *= -1;
    gctx.globalAlpha = st.o;
    gctx.fillStyle = st.c;
    gctx.beginPath();
    gctx.arc(Math.cos(st.a)*st.r, Math.sin(st.a)*st.r, 2, 0, Math.PI*2);
    gctx.fill();
  }
  gctx.restore();
  gctx.globalAlpha = 1;
  requestAnimationFrame(animateGalaxy);
}
animateGalaxy();

/* ================= üéµ AUDIO (BOT√ìN EXTRA SI BLOQUEA) ================= */
const audioBar = document.getElementById("audioBar");
const audioMsg = document.getElementById("audioMsg");
const audioBtn = document.getElementById("audioBtn");

function showAudioBar(msg){
  audioMsg.textContent = msg;
  audioBar.style.display = "flex";
}
function hideAudioBar(){
  audioBar.style.display = "none";
}

const music = new Audio("./cancion.mp3");
music.loop = true;
music.preload = "auto";
music.volume = 0.85;

async function tryPlayMusic(){
  try{
    await music.play();
    hideAudioBar();
    return true;
  }catch(e){
    // Mostramos bot√≥n manual para activar
    showAudioBar("üîá Tu navegador bloque√≥ el audio. Presiona ‚ñ∂ Activar m√∫sica.");
    return false;
  }
}

// Aviso si el archivo no existe
fetch("./cancion.mp3", { method: "HEAD" })
  .then(r => { if(!r.ok) showAudioBar("‚ùå No se encuentra cancion.mp3 (revisa el nombre en GitHub)"); })
  .catch(()=> showAudioBar("‚ùå No se pudo cargar cancion.mp3"));

// Bot√≥n extra para activar m√∫sica
audioBtn.onclick = () => { tryPlayMusic(); };

// Tambi√©n lo intenta en el primer toque/clic en pantalla
window.addEventListener("pointerdown", () => { tryPlayMusic(); }, { once:true });
window.addEventListener("touchstart", () => { tryPlayMusic(); }, { once:true });

/* ================= üíñ CONTADOR ================= */
const loveCounter = document.getElementById("loveCounter");
const loveStart = new Date("June 20, 2024 00:00:00").getTime();

function updateLoveCounter(){
  const now = Date.now();
  const diff = now - loveStart;
  const d = Math.floor(diff / (1000*60*60*24));
  const h = Math.floor((diff / (1000*60*60)) % 24);
  const m = Math.floor((diff / (1000*60)) % 60);
  const s = Math.floor((diff / 1000) % 60);
  loveCounter.textContent = `Te he querido por ${d} d√≠as, ${h}h ${m}m ${s}s üíñ`;
}

/* ================= üíñ SORPRESA ORBITANDO ================= */
const layer = document.getElementById("surpriseLayer");
const phrases = [
  "Te amo ranita üíñüê∏",
  "Gracias por existir üåπ",
  "Eres mi universo ‚ú®",
  "Mi Diana hermosa üíû",
  "Siempre juntos ‚ù§Ô∏è",
  "Mi lugar favorito eres t√∫ üíò"
];

let orbiters = [];

function makeOrbit(node,r,s,a){
  const o = document.createElement("div");
  o.className = "orbit";
  o.dataset.r = r;
  o.dataset.s = s;
  o.dataset.a = a;
  o.appendChild(node);
  layer.appendChild(o);
  orbiters.push(o);
}

function orbitLoop(){
  const t = performance.now();
  for (const o of orbiters){
    const r = +o.dataset.r;
    const s = +o.dataset.s;
    const a = +o.dataset.a + t*s;
    o.style.transform =
      `translate(-50%,-50%) translate(${Math.cos(a)*r}px,${Math.sin(a)*(r*0.7)}px)`;
  }
  requestAnimationFrame(orbitLoop);
}

function spawn(){
  ["foto1.jpg","foto2.jpg"].forEach((src,i)=>{
    const img = document.createElement("img");
    img.src = src;
    img.className = "floatingMedia";
    makeOrbit(img, 320 + i*180, 0.00025 + i*0.00008, Math.random()*Math.PI*2);
  });

  ["video1.mp4","video2.mp4"].forEach((src,i)=>{
    const v = document.createElement("video");
    v.src = src;
    v.autoplay = true;
    v.loop = true;
    v.muted = true;
    v.playsInline = true;
    v.className = "floatingMedia";
    makeOrbit(v, 420 + i*200, 0.00018 + i*0.00007, Math.random()*Math.PI*2);
  });

  phrases.forEach((txt,i)=>{
    const t = document.createElement("div");
    t.className = "floatingText";
    t.innerText = txt;
    makeOrbit(t, 220 + i*120, 0.00035 + i*0.00005, Math.random()*Math.PI*2);
  });

  orbitLoop();
}

/* ================= BOT√ìN ================= */
const startBtn = document.getElementById("startBtn");
let counterTimer = null;

startBtn.onclick = async () => {
  // Intento de m√∫sica (si bloquea, sale bot√≥n ‚ÄúActivar m√∫sica‚Äù)
  await tryPlayMusic();

  // contador
  loveCounter.style.display = "block";
  updateLoveCounter();
  if (counterTimer) clearInterval(counterTimer);
  counterTimer = setInterval(updateLoveCounter, 1000);

  startBtn.style.display = "none";
  spawn();
};
</script>
</body>
</html>
